## Определение

**Префиксная сумма** - сумма элементов массива, начиная с первого и заканчивания $i$-м элементом.

Префиксная сумма задается рекуррентно:
$$
\begin{align*}
b_0 &= 0,
\\
b_{i+1} &= b_{i} + a_i &\quad \text{для} \quad i \geq 0.
\end{align*}
$$
В данном случае используются полуинтервалы, так как с ними удобнее работать. Т.е. $b_{i}$ это сумма элементов массива на полуинтервале $[0, i)$.

**Важно**:
Массив префиксных сумм состоит из суммы большого количества элементов, поэтому нужно всегда помнить о возможности переполнения.

![[Префиксная сумма.png]]

## Применение

Пусть у нас уже подсчитаны все префиксные суммы массива. Тогда для <u>нахождения суммы элементов от $l$ до $r$</u> можно воспользоваться этими суммами.
```
int get_sum(int left, int right){    // [left, right)
	return b[right] - b[left]
}
```

<u>Надо помнить</u>:
Префиксная сумма используется только в тех массивах, которые не изменяются.

Также ее можно использовать для подсчета <u>количества попаданий в точки на отрезке</u>. Например, дан отрезок, к каждой точке которого нужно прибавить 1. Отметим (начало) отрезка в +1 и (конец + 1) в -1, при подсчете префиксной суммы весь отрезок будет увеличен на +1.

## Другие операции

Префиксные суммы можно использовать с любыми операциями, которые <u>являются обратимыми</u>. Т.е. возможность по двум префиксами на отрезке восстановить значение на отрезке.

Например, операция $+$ обратима, однако, максимум и минимум нет, так как такой элемент может стоять перед нужным отрезком, тем самым на самом отрезке определить максимум/минимум будет невозможно.

<u>Формула XOR на отрезке</u>:
$$
a_{l} \oplus a_{l+1} \oplus \dots \oplus a_{r-1} = b_{r} \oplus b_{l}
$$

## Двумерный случай

## Трехмерный случай

## Разностный массив

## Двумерный разностный массив